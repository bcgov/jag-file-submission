version: "3.7"
services:

  #############################################################################################
  ###                                 EFILING FRONTEND                                      ###
  #############################################################################################
  efiling-frontend:
    build:
      context: ./src/frontend/efiling-frontend

  #############################################################################################
  ###                           Efiling api backend app                                     ###
  #############################################################################################
  efiling-api:
    build:
      context: ./src/backend
      dockerfile: Dockerfile.efiling-api
      args:
        - MVN_PROFILE=${MVN_PROFILE:-efiling-api-demo}
        - SKIP_TESTS=true
        - STARTERS_V=v0.1.8

  # #############################################################################################
  # ###                                        KEYCLOAK Config                                ###
  # #############################################################################################
  keycloak-config:
    build:
      context: ./infrastructure/keycloak
      args:
        - KEYCLOAK_URL=http://keycloak:8080

  #############################################################################################
  ###                           Efiling reviewer api backend app                                     ###
  #############################################################################################
  efiling-reviewer-api:
    build:
      context: ./src/backend
      dockerfile: Dockerfile.efiling-reviewer-api
      args:
        - MVN_PROFILE=${MVN_PROFILE:-efiling-reviewer}
        - SKIP_TESTS=true
    environment:
      - DILIGEN_BASE_PATH=http://ai-reviewer-mock-api:1337

  #############################################################################################
  ###                           AI Reviewer Mock Service                                    ###
  #############################################################################################
  ai-reviewer-mock-api:
    build:
      context: ./src/backend
      dockerfile: Dockerfile.ai-reviewer-mock-api
      args:
        - SKIP_TESTS=true
        - MVN_PROFILE=${MVN_PROFILE:-ai-reviewer-mock}
        - STARTERS_V=v0.1.8
